C251 COMPILER V5.60.0,  time                                                               08/01/26  16:48:08  PAGE 1   


C251 COMPILER V5.60.0, COMPILATION OF MODULE time
OBJECT MODULE PLACED IN .\Objects\time.obj
COMPILER INVOKED BY: D:\AI-KEIL5\C251\BIN\C251.EXE Sources\time.c XSMALL BROWSE INCDIR(.\Sources) DEBUG PRINT(.\Listings
                    -\time.lst) OBJECT(.\Objects\time.obj) 

stmt  level    source

    1          #include "config.h"                     //头文件中已包含ai8051u.h, ai_usb.h以及其他头文件
    2          #include "time.h"
    3          #include "adc_key.h"
    4          #include "ai_usb.h"
    5          #include "oled.h"
    6          
    7          u8  cnt10ms;
    8          bit B_1ms;          //1ms标志
    9          u16 j;
   10          u16 msecond;
   11          u8 dis_num_str[10];
   12          u8 num=0;
   13          
   14          void Timer0_Init(void)
   15          {
   16   1          AUXR |= 0x80;       //Timer0 set as 1T, 16 bits timer auto-reload, 
   17   1          TH0 = (u8)(Timer0_Reload / 256);
   18   1          TL0 = (u8)(Timer0_Reload % 256);
   19   1          ET0 = 1;            //Timer0 interrupt enable
   20   1          TR0 = 1;            //Tiner0 run
   21   1      }
   22          
   23          void time_out()
   24          {
   25   1      
   26   1              if(B_1ms)   //1ms到
   27   1              {
   28   2                  B_1ms = 0;
   29   2                  if(++msecond >= 1000)   //1秒到
   30   2                  {
   31   3                      msecond = 0;
   32   3                      
   33   3                  }
   34   2      
   35   2                  if(++cnt10ms >= 10) //10ms读一次ADC
   36   2                  {
   37   3                      cnt10ms = 0;
   38   3                      j = Get_ADC12bitResult(0);  //参数0~15,查询方式做一次ADC, 返回值就是结果, == 4096 为错误
   39   3                      if(j < 4096)    CalculateAdcKey(j); //计算按键
   40   3                  }
   41   2                  
   42   2              }
   43   1              if(KeyCode > 0)     //有键按下
   44   1                  {
   45   2                      if(KeyCode == 1)    
   46   2                      {
   47   3                          WaveData[0]=high_level_num;
   48   3                      }
   49   2                      if(KeyCode == 2)    
   50   2                      {
   51   3                          WaveData[0]=low_level_num;
   52   3                      }
   53   2                      if(KeyCode == 3)    
   54   2                      {
   55   3                          num=0;
   56   3                      }
   57   2                      if(KeyCode == 4)    
   58   2                      {
C251 COMPILER V5.60.0,  time                                                               08/01/26  16:48:08  PAGE 2   

   59   3                          num=10;
   60   3                      }
   61   2                      KeyCode = 0;
   62   2                  }
   63   1      
   64   1                          
   65   1      }
   66          
   67          
   68          void timer0() interrupt 1
   69          {
   70   1          B_1ms = 1;      //1ms标志
   71   1      }


Module Information          Static   Overlayable
------------------------------------------------
  code size            =       144     ------
  ecode size           =    ------     ------
  data size            =    ------     ------
  idata size           =    ------     ------
  pdata size           =    ------     ------
  xdata size           =    ------     ------
  xdata-const size     =    ------     ------
  edata size           =        16     ------
  bit size             =         1     ------
  ebit size            =    ------     ------
  bitaddressable size  =    ------     ------
  ebitaddressable size =    ------     ------
  far data size        =    ------     ------
  huge data size       =    ------     ------
  const size           =    ------     ------
  hconst size          =         5     ------
End of Module Information.


C251 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
